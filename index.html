<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>CHRONO ATLAS</title>

<link rel="manifest" href="manifest.json" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icon.png">

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Orbitron:wght@500;900&family=Zen+Old+Mincho&display=swap" rel="stylesheet">

<style>
/* === Â§âÊï∞ÂÆöÁæ© === */
:root {
    --bg-void: #050202;
    --neon-cyan: #00f3ff;
    --neon-amber: #ffaa00;
    --steam-gold: #cfaa68;
    --steam-rust: #8b4513;
    --glass-panel: rgba(20, 10, 5, 0.7);
}

body {
    margin: 0;
    background-color: var(--bg-void);
    color: #fff;
    font-family: 'Orbitron', sans-serif;
    overflow-x: hidden;
    overflow-y: auto; /* „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅåÂ§ö„ÅÑ„ÅÆ„ÅßÁ∏¶„Çπ„ÇØ„É≠„Éº„É´Ë®±ÂèØ */
    height: 100vh;
    width: 100vw;
    -webkit-touch-callout: none;
    user-select: none;
}

/* === ËÉåÊôØË£ÖÈ£æ === */
.bg-layer {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: -2;
    background: radial-gradient(circle at center, #1a0d00 0%, #000000 90%);
    pointer-events: none;
}

/* Â∑®Â§ßÊ≠ØËªäÔºàËÉåÊôØÔºâ */
.giant-gear {
    position: fixed;
    top: -20%; right: -30%;
    width: 100vw; height: 100vw;
    opacity: 0.15;
    animation: rotate 120s linear infinite;
    fill: var(--steam-gold);
    z-index: -1;
}
@keyframes rotate { to { transform: rotate(360deg); } }

/* ÊòüÂ∫ß„Éë„Éº„ÉÜ„Ç£„ÇØ„É´ */
.stars {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background-image: 
        radial-gradient(2px 2px at 20px 30px, #fff, transparent),
        radial-gradient(2px 2px at 40px 70px, #fff, transparent),
        radial-gradient(2px 2px at 50px 160px, #fff, transparent),
        radial-gradient(2px 2px at 90px 40px, #fff, transparent),
        radial-gradient(2px 2px at 130px 80px, #fff, transparent);
    background-size: 200px 200px;
    opacity: 0.3;
    animation: twinkle 5s infinite;
    z-index: -1;
}
@keyframes twinkle { 50% { opacity: 0.1; } }

/* === „É°„Ç§„É≥„É¨„Ç§„Ç¢„Ç¶„Éà === */
.dashboard {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    gap: 20px;
    width: 100%;
    box-sizing: border-box;
    max-width: 500px;
    margin: 0 auto;
}

/* 1. Êáê‰∏≠ÊôÇË®à (Main Clock) */
.pocket-watch {
    position: relative;
    width: 220px; height: 220px;
    margin-top: 20px;
    background: radial-gradient(circle, #221100, #000);
    border: 4px double var(--steam-gold);
    border-radius: 50%;
    box-shadow: 0 0 20px var(--steam-gold), inset 0 0 30px #000;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
}
/* ÊôÇË®à„ÅÆÈ£æ„Çä */
.watch-top {
    position: absolute;
    top: -15px; left: 50%; transform: translateX(-50%);
    width: 30px; height: 20px;
    background: var(--steam-gold);
    border-radius: 4px;
}
.watch-ring {
    position: absolute;
    top: -35px; left: 50%; transform: translateX(-50%);
    width: 40px; height: 40px;
    border: 4px solid var(--steam-gold);
    border-radius: 50%;
}
#main-clock {
    font-size: 42px;
    color: var(--neon-amber);
    text-shadow: 0 0 10px var(--neon-amber);
    z-index: 2;
}
#date-display {
    font-size: 14px;
    color: var(--steam-gold);
    margin-top: 5px;
    font-family: 'Cinzel', serif;
}

/* 2. Â§©Ê∞ó‰∫àÂ†±„Éë„Éç„É´ (Weather Widget) */
.weather-panel {
    width: 100%;
    background: var(--glass-panel);
    border: 1px solid var(--steam-gold);
    border-radius: 8px;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 0 10px rgba(0, 243, 255, 0.1);
    backdrop-filter: blur(5px);
}
.weather-info {
    text-align: left;
}
.temp-display {
    font-size: 32px;
    color: var(--neon-cyan);
    text-shadow: 0 0 5px var(--neon-cyan);
}
.loc-display {
    font-size: 12px;
    color: #aaa;
}
.weather-icon {
    font-size: 32px;
}

/* 3. „Ç¨„Ç∏„Çß„ÉÉ„Éà„Ç∞„É™„ÉÉ„Éâ (Compass, Meter, etc.) */
.widget-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    width: 100%;
}

.widget-box {
    background: rgba(0,0,0,0.6);
    border: 1px solid var(--steam-rust);
    border-radius: 8px;
    padding: 10px;
    height: 100px;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
.widget-title {
    position: absolute;
    top: 5px; left: 10px;
    font-size: 10px;
    color: var(--steam-gold);
    opacity: 0.7;
}

/* „Ç≥„É≥„Éë„Çπ */
.compass-ring {
    width: 60px; height: 60px;
    border: 2px dashed var(--neon-cyan);
    border-radius: 50%;
    position: relative;
    animation: driftCompass 5s ease-in-out infinite alternate;
}
.compass-needle {
    position: absolute;
    top: 50%; left: 50%;
    width: 4px; height: 100%;
    background: linear-gradient(to top, red 50%, white 50%);
    transform: translate(-50%, -50%) rotate(0deg); /* JS„ÅßÂà∂Âæ° */
    clip-path: polygon(50% 0, 0 50%, 50% 100%, 100% 50%);
}
@keyframes driftCompass { from { transform: rotate(-5deg); } to { transform: rotate(5deg); } }

/* Ëí∏Ê∞ó„É°„Éº„Çø„Éº */
.steam-gauge {
    width: 80%; height: 10px;
    background: #333;
    border-radius: 5px;
    overflow: hidden;
    margin-top: 10px;
    border: 1px solid #555;
}
.steam-bar {
    width: 50%; height: 100%;
    background: linear-gradient(90deg, #ffaa00, #ff0000);
    transition: width 0.5s;
    box-shadow: 0 0 10px #ff0000;
}
.meter-val {
    font-size: 20px; color: #ff5555;
    margin-top: 5px;
}

/* „Ç¢„Éº„ÉÜ„Ç£„Éï„Ç°„ÇØ„ÉàÔºàÁæΩÊ†π„ÉªÈçµÔºâ */
.artifact-icon {
    font-size: 40px;
    filter: drop-shadow(0 0 5px var(--steam-gold));
    cursor: pointer;
    transition: 0.2s;
}
.artifact-icon:hover { transform: scale(1.1); filter: drop-shadow(0 0 10px var(--neon-cyan)); }

/* 4. Ê§úÁ¥¢„Éê„Éº */
.search-wrapper {
    width: 100%;
    position: relative;
    margin-top: 10px;
}
#search {
    width: 100%;
    background: rgba(0,0,0,0.8);
    border: 1px solid var(--neon-cyan);
    color: var(--neon-cyan);
    padding: 12px;
    font-family: 'Orbitron';
    font-size: 16px;
    box-sizing: border-box;
    outline: none;
    box-shadow: 0 0 5px rgba(0, 243, 255, 0.3);
}

/* 5. „Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà */
.shortcuts {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    width: 100%;
}
.sc-btn {
    aspect-ratio: 1;
    background: linear-gradient(135deg, #1a1a1a, #0a0a0a);
    border: 1px solid var(--steam-gold);
    border-radius: 50%; /* Êáê‰∏≠ÊôÇË®àÈ¢®„ÅÆ‰∏∏„Éú„Çø„É≥ */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 10px;
    color: #aaa;
    text-decoration: none;
    cursor: pointer;
    box-shadow: inset 0 0 10px #000;
}
.sc-btn:hover {
    border-color: var(--neon-cyan);
    color: #fff;
    box-shadow: 0 0 10px var(--neon-cyan);
}

/* „É≠„Ç∞Ë°®Á§∫ */
.log-area {
    width: 100%;
    height: 60px;
    font-size: 12px;
    color: var(--steam-gold);
    text-align: center;
    font-family: 'Zen Old Mincho', serif;
    opacity: 0.8;
    margin-top: 20px;
}

</style>
</head>
<body>

    <div class="bg-layer">
        <div class="stars"></div>
        <svg class="giant-gear" viewBox="0 0 100 100">
             <path d="M50 0 L56 10 L68 8 L72 20 L84 18 L88 30 L100 30 L94 40 L100 50 L94 60 L100 70 L88 70 L84 82 L72 80 L68 92 L56 90 L50 100 L44 90 L32 92 L28 80 L16 82 L12 70 L0 70 L6 60 L0 50 L6 40 L0 30 L12 30 L16 18 L28 20 L32 8 L44 10 Z" />
        </svg>
    </div>

    <div class="dashboard">
        <div class="pocket-watch">
            <div class="watch-ring"></div>
            <div class="watch-top"></div>
            <div id="main-clock">00:00</div>
            <div id="date-display">----/--/--</div>
        </div>

        <div class="weather-panel">
            <div class="weather-info">
                <div class="loc-display" id="weather-loc">DETECTING LOCATION...</div>
                <div class="temp-display" id="weather-temp">--¬∞C</div>
            </div>
            <div class="weather-icon" id="weather-icon">‚òÅ</div>
        </div>

        <div class="widget-grid">
            <div class="widget-box">
                <div class="widget-title">COMPASS</div>
                <div class="compass-ring">
                    <div class="compass-needle" id="compass-needle"></div>
                </div>
                <div style="margin-top:5px; font-size:10px;">NORTH</div>
            </div>

            <div class="widget-box">
                <div class="widget-title">STEAM PRESSURE</div>
                <div class="meter-val" id="pressure-val">0%</div>
                <div class="steam-gauge">
                    <div class="steam-bar" id="steam-bar"></div>
                </div>
            </div>

            <div class="widget-box" onclick="logMsg('Êòü„ÅÆÈÖçÁΩÆ„ÇíË®àÁÆó‰∏≠...')">
                <div class="widget-title">CONSTELLATION</div>
                <div class="artifact-icon">‚ú®</div>
            </div>

            <div class="widget-box" onclick="logMsg('„Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éª„Ç≤„Éº„ÉàÁ¢∫Ë™çÔºöÊ≠£Â∏∏')">
                <div class="widget-title">KEY SYSTEM</div>
                <div class="artifact-icon">üóù</div>
            </div>
            
            <div class="widget-box" onclick="logMsg('‰ºùÊõ∏È≥©„Éó„É≠„Éà„Ç≥„É´ÔºöÂæÖÊ©ü‰∏≠')">
                <div class="widget-title">MESSENGER</div>
                <div class="artifact-icon">ü™∂</div>
            </div>
            
             <div class="widget-box" onclick="location.reload()">
                <div class="widget-title">RELOAD</div>
                <div class="artifact-icon">‚öô</div>
            </div>
        </div>

        <div class="search-wrapper">
            <input type="text" id="search" placeholder="> COMMAND SEARCH...">
        </div>

        <div class="shortcuts">
            <a class="sc-btn" onclick="openLink('https://google.com')">GOOGLE</a>
            <a class="sc-btn" onclick="openLink('https://youtube.com')">YOUTUBE</a>
            <a class="sc-btn" onclick="openLink('https://x.com')">X / NET</a>
            <a class="sc-btn" onclick="openLink('https://chatgpt.com')">AI CHAT</a>
        </div>

        <div class="log-area" id="log-display">System Ready.</div>
    </div>

    <script>
        // === 1. ÊôÇË®à ===
        function updateClock() {
            const now = new Date();
            const h = String(now.getHours()).padStart(2, '0');
            const m = String(now.getMinutes()).padStart(2, '0');
            const s = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('main-clock').innerText = `${h}:${m}:${s}`;
            
            const days = ['SUN','MON','TUE','WED','THU','FRI','SAT'];
            document.getElementById('date-display').innerText = 
                `${now.getFullYear()}.${now.getMonth()+1}.${now.getDate()} [${days[now.getDay()]}]`;
        }
        setInterval(updateClock, 1000);

        // === 2. ÂÆüÁî®ÁöÑ„Å™Â§©Ê∞ó‰∫àÂ†± (Open-Meteo API) ===
        // ÁôªÈå≤‰∏çË¶Å„ÅÆÁÑ°ÊñôAPI„Çí‰ΩøÁî®
        async function fetchWeather(lat, lon) {
            try {
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`;
                const res = await fetch(url);
                const data = await res.json();
                
                const temp = data.current_weather.temperature;
                const code = data.current_weather.weathercode;
                
                document.getElementById('weather-temp').innerText = `${temp}¬∞C`;
                document.getElementById('weather-loc').innerText = `LAT:${lat.toFixed(2)} LON:${lon.toFixed(2)}`;
                
                // Â§©Ê∞ó„Ç≥„Éº„ÉâÁ∞°ÊòìÂ§âÊèõ
                let icon = "‚òÅ";
                if(code === 0) icon = "‚òÄ"; // Âø´Êô¥
                else if(code <= 3) icon = "‚õÖ"; // Êõá„Çä
                else if(code <= 67) icon = "‚òÇ"; // Èõ®
                else if(code <= 86) icon = "‚ùÑ"; // Èõ™
                else icon = "‚õà"; // Èõ∑Èõ®
                
                document.getElementById('weather-icon').innerText = icon;
                logMsg("Ê∞óË±°„Éá„Éº„Çø„ÅÆÂèó‰ø°ÂÆå‰∫Ü");
            } catch (e) {
                document.getElementById('weather-loc').innerText = "CONNECTION FAILED";
            }
        }

        // ‰ΩçÁΩÆÊÉÖÂ†±ÂèñÂæó
        function initWeather() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        fetchWeather(pos.coords.latitude, pos.coords.longitude);
                    },
                    (err) => {
                        // Ë®±ÂèØ„Åï„Çå„Å™„ÅÑÂ†¥Âêà„ÅØÊù±‰∫¨„ÅÆÂ∫ßÊ®ô„Çí‰ΩøÁî®
                        document.getElementById('weather-loc').innerText = "LOCATION DENIED (DEFAULT: TOKYO)";
                        fetchWeather(35.6895, 139.6917);
                    }
                );
            } else {
                fetchWeather(35.6895, 139.6917);
            }
        }
        // ÂàùÂõûÂÆüË°å„Å®10ÂàÜ„Åî„Å®„ÅÆÊõ¥Êñ∞
        initWeather();
        setInterval(initWeather, 600000); 

        // === 3. „ÇÆ„Éü„ÉÉ„ÇØÂà∂Âæ° ===
        
        // Ëí∏Ê∞ó„É°„Éº„Çø„Éº„ÅÆ„É©„É≥„ÉÄ„É†Â§âÂãï
        setInterval(() => {
            const val = Math.floor(Math.random() * 100);
            document.getElementById('steam-bar').style.width = val + "%";
            document.getElementById('pressure-val').innerText = val + "%";
        }, 2000);

        // „Ç≥„É≥„Éë„ÇπÂà∂Âæ° („Éá„Éê„Ç§„Çπ„ÅÆÊñπËßíÂèñÂæó„ÅØË§áÈõë„Å™„Åü„ÇÅ„ÄÅÊì¨‰ººÁöÑ„Å™Êè∫„Çâ„Åé„ÅßÊºîÂá∫)
        // „Çπ„Éû„Éõ„ÅÆÂ†¥Âêà„ÅØÂÆüÈöõ„Å´Âãï„Åè„Çà„ÅÜ„Å´Ë©¶„Åø„Çã
        if (window.DeviceOrientationEvent) {
            window.addEventListener('deviceorientation', (event) => {
                if(event.alpha) {
                    const rotate = 360 - event.alpha;
                    document.getElementById('compass-needle').style.transform = 
                        `translate(-50%, -50%) rotate(${rotate}deg)`;
                }
            });
        }

        // === 4. ÂÖ±ÈÄöÊ©üËÉΩ ===
        function openLink(url) { window.location.href = url; }
        
        const sBox = document.getElementById('search');
        sBox.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const q = sBox.value;
                if(q) location.href = `https://www.google.com/search?q=${encodeURIComponent(q)}`;
            }
        });

        function logMsg(msg) {
            const log = document.getElementById('log-display');
            log.innerText = "> " + msg;
            log.style.opacity = 1;
            setTimeout(() => { log.style.opacity = 0.7; }, 200);
        }

        // Service Worker
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("service-worker.js");
        }
    </script>
</body>
</html>
