<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AETHER CHRONICLE</title>

<link rel="manifest" href="manifest.json" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icon.png">

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Orbitron:wght@500;900&family=Zen+Old+Mincho&display=swap" rel="stylesheet">

<style>
/* === „Éá„Ç∂„Ç§„É≥Â§âÊï∞ === */
:root {
    --bg-void: #080808;
    --neon-cyan: #00f3ff;
    --neon-pink: #ff0055;
    --neon-purple: #bc13fe;
    --silver-metal: #e0e5eb;
    --glass: rgba(20, 20, 30, 0.6);
}

body {
    margin: 0;
    background-color: var(--bg-void);
    color: #fff;
    font-family: 'Orbitron', sans-serif;
    overflow-x: hidden;
    height: 100vh;
    width: 100vw;
    -webkit-touch-callout: none;
    user-select: none;
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* === ËÉåÊôØ (Âãï„ÅèÈúß + „Ç∞„É™„ÉÉ„Éâ) === */
.bg-layer {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: -2;
    background: radial-gradient(circle at center, #1a1a2e 0%, #000 90%);
}
.grid-bg {
    position: absolute;
    width: 200%; height: 200%;
    background-image: 
        linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-200px);
    animation: gridMove 20s linear infinite;
}
@keyframes gridMove { from { transform: perspective(500px) rotateX(60deg) translateY(0) translateZ(-200px); } to { transform: perspective(500px) rotateX(60deg) translateY(40px) translateZ(-200px); } }

/* ËÉåÊôØ„ÅÆÊ≠ØËªäÔºà„Ç∑„É´„Ç®„ÉÉ„ÉàÔºâ */
.gear-bg {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 90vw; height: 90vw;
    opacity: 0.05;
    fill: var(--silver-metal);
    animation: rotateGear 60s linear infinite;
    z-index: -1;
    pointer-events: none;
}
@keyframes rotateGear { to { transform: translate(-50%, -50%) rotate(360deg); } }

/* === 1. ‰∏äÈÉ®ÔºöÂÆüÁî®„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà (Shortcut Dock) === */
.top-dock {
    width: 100%;
    padding: 20px 0;
    background: linear-gradient(to bottom, rgba(0,0,0,0.9), transparent);
    display: flex;
    justify-content: center;
    gap: 12px;
    z-index: 100;
}

.icon-btn {
    position: relative;
    width: 70px; height: 70px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 14px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    backdrop-filter: blur(5px);
    transition: 0.3s;
    overflow: hidden;
    text-decoration: none;
    color: #fff;
}
.icon-btn:active { transform: scale(0.95); }
.icon-btn:hover {
    border-color: var(--neon-cyan);
    box-shadow: 0 0 15px var(--neon-cyan);
}
.icon-symbol { font-size: 22px; margin-bottom: 4px; color: var(--silver-metal); }
.icon-label { font-size: 9px; color: #aaa; letter-spacing: 0.5px; }

/* === 2. ‰∏≠Â§ÆÔºöÊôÇË®à (Chrono Core) === */
.main-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 100%;
    position: relative;
}

/* È≠îÊ≥ïÈô£„ÅÆ„Çà„ÅÜ„Å™ÊôÇË®à„Çµ„Éº„ÇØ„É´ */
.clock-circle {
    position: relative;
    width: 260px; height: 260px;
    display: flex;
    justify-content: center;
    align-items: center;
}
.ring-outer {
    position: absolute;
    width: 100%; height: 100%;
    border: 1px dashed var(--neon-purple);
    border-radius: 50%;
    animation: spin 30s linear infinite reverse;
    opacity: 0.5;
}
.ring-inner {
    position: absolute;
    width: 80%; height: 80%;
    border: 2px solid var(--neon-cyan);
    border-radius: 50%;
    border-top-color: transparent;
    border-bottom-color: transparent;
    animation: spin 10s linear infinite;
    box-shadow: 0 0 10px var(--neon-cyan);
}
@keyframes spin { to { transform: rotate(360deg); } }

/* ÊôÇÂàªË°®Á§∫Ôºà„Ç∞„É™„ÉÉ„ÉÅ„Ç®„Éï„Çß„ÇØ„ÉàÂº∑ÂåñÔºâ */
.time-box { text-align: center; z-index: 10; }
#time-text {
    font-size: 60px;
    font-weight: 900;
    color: #fff;
    text-shadow: 2px 0 var(--neon-cyan), -2px 0 var(--neon-pink);
    letter-spacing: 2px;
    line-height: 1;
    position: relative;
    display: inline-block;
}
/* Âº∑ÁÉà„Å™„Ç∞„É™„ÉÉ„ÉÅ */
.glitch-effect {
    animation: glitch-skew 1s infinite linear alternate-reverse;
}
.glitch-effect::before, .glitch-effect::after {
    content: attr(data-text);
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: var(--bg-void);
}
.glitch-effect::before {
    left: 2px;
    text-shadow: -1px 0 #ff00c1;
    clip: rect(44px, 450px, 56px, 0);
    animation: glitch-anim 5s infinite linear alternate-reverse;
}
.glitch-effect::after {
    left: -2px;
    text-shadow: -1px 0 #00fff9;
    clip: rect(44px, 450px, 56px, 0);
    animation: glitch-anim2 5s infinite linear alternate-reverse;
}
@keyframes glitch-anim {
    0% { clip: rect(2px, 9999px, 5px, 0); }
    20% { clip: rect(30px, 9999px, 60px, 0); }
    40% { clip: rect(10px, 9999px, 85px, 0); }
    60% { clip: rect(50px, 9999px, 20px, 0); }
    80% { clip: rect(15px, 9999px, 40px, 0); }
    100% { clip: rect(60px, 9999px, 70px, 0); }
}
@keyframes glitch-anim2 {
    0% { clip: rect(60px, 9999px, 10px, 0); }
    20% { clip: rect(10px, 9999px, 40px, 0); }
    40% { clip: rect(50px, 9999px, 20px, 0); }
    60% { clip: rect(15px, 9999px, 60px, 0); }
    80% { clip: rect(70px, 9999px, 30px, 0); }
    100% { clip: rect(30px, 9999px, 80px, 0); }
}

#date-text {
    font-family: 'Cinzel', serif;
    font-size: 14px;
    color: var(--neon-pink);
    letter-spacing: 4px;
    margin-top: 10px;
}

/* Ê§úÁ¥¢„Éê„Éº */
.search-container {
    width: 80%;
    max-width: 400px;
    margin-top: 30px;
    position: relative;
}
#search {
    width: 100%;
    background: transparent;
    border: none;
    border-bottom: 2px solid var(--silver-metal);
    color: #fff;
    font-family: 'Orbitron';
    font-size: 18px;
    padding: 10px;
    text-align: center;
    outline: none;
    transition: 0.3s;
}
#search:focus {
    border-color: var(--neon-pink);
    box-shadow: 0 4px 10px -2px rgba(255, 0, 85, 0.5);
}

/* === 3. ‰∏ãÈÉ®Ôºö„Ç¶„Ç£„Ç∏„Çß„ÉÉ„Éà„Éá„ÉÉ„Ç≠ === */
.widget-deck {
    width: 100%;
    max-width: 500px;
    padding: 20px;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-bottom: 20px;
    box-sizing: border-box;
}

.widget {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 10px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100px;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    text-decoration: none;
    color: #fff;
    transition: 0.2s;
}
.widget:active { background: rgba(255, 255, 255, 0.1); }
.widget-label {
    font-size: 10px;
    color: var(--neon-cyan);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: 5px;
}

/* Â§©Ê∞ó„Ç¶„Ç£„Ç∏„Çß„ÉÉ„Éà */
.weather-main {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 0px;
}
.temp-big { font-size: 28px; font-weight: bold; text-shadow: 0 0 5px #fff; }
.weather-icon { font-size: 26px; }
.loc-small { font-size: 9px; color: #888; margin-top: 2px; }

/* „Çø„Ç§„Éû„ÉºÔºàÊáê‰∏≠ÊôÇË®à„Éá„Ç∂„Ç§„É≥Ôºâ */
.watch-face {
    width: 50px; height: 50px;
    border: 2px solid var(--silver-metal);
    border-radius: 50%;
    position: absolute;
    bottom: 10px; right: 10px;
    background: radial-gradient(#222, #000);
    box-shadow: 0 0 5px var(--silver-metal);
}
.watch-knob {
    position: absolute;
    top: -4px; left: 50%; transform: translateX(-50%);
    width: 6px; height: 4px; background: var(--silver-metal);
}
.watch-hand {
    position: absolute;
    top: 50%; left: 50%; width: 45%; height: 2px;
    background: var(--neon-pink);
    transform-origin: 0 50%;
    animation: tick 60s linear infinite;
}
@keyframes tick { from { transform: rotate(-90deg); } to { transform: rotate(270deg); } }

/* „Ç∑„Çπ„ÉÜ„É†Ë≤†Ëç∑Ôºà„Éê„ÉºÔºâ */
.bar-container {
    display: flex;
    align-items: flex-end;
    gap: 2px;
    height: 40px;
    margin-top: 10px;
}
.bar {
    flex: 1;
    background: var(--neon-purple);
    opacity: 0.5;
    transition: height 0.2s;
}

/* „É°„É¢Â∏≥ */
#memo-area {
    width: 100%;
    height: 60px;
    background: transparent;
    border: none;
    color: #aaa;
    font-family: 'Zen Old Mincho', serif;
    font-size: 11px;
    resize: none;
    outline: none;
    line-height: 1.4;
}
#memo-area::placeholder { color: #555; font-style: italic; }

</style>
</head>
<body>

    <div class="bg-layer">
        <div class="grid-bg"></div>
        <svg class="gear-bg" viewBox="0 0 100 100">
             <path d="M50 0 L56 10 L68 8 L72 20 L84 18 L88 30 L100 30 L94 40 L100 50 L94 60 L100 70 L88 70 L84 82 L72 80 L68 92 L56 90 L50 100 L44 90 L32 92 L28 80 L16 82 L12 70 L0 70 L6 60 L0 50 L6 40 L0 30 L12 30 L16 18 L28 20 L32 8 L44 10 Z" />
        </svg>
    </div>

    <div class="top-dock">
        <a class="icon-btn" href="https://youtube.com">
            <div class="icon-symbol">‚ñ∂</div>
            <div class="icon-label">YOUTUBE</div>
        </a>
        <a class="icon-btn" href="https://gemini.google.com">
            <div class="icon-symbol">‚ú¶</div>
            <div class="icon-label">GEMINI</div>
        </a>
        <a class="icon-btn" href="https://music.apple.com">
            <div class="icon-symbol">‚ô´</div>
            <div class="icon-label">MUSIC</div>
        </a>
        <a class="icon-btn" href="https://maps.google.com">
            <div class="icon-symbol">üó∫</div>
            <div class="icon-label">MAPS</div>
        </a>
    </div>

    <div class="main-section">
        <div class="clock-circle">
            <div class="ring-outer"></div>
            <div class="ring-inner"></div>
            
            <div class="time-box">
                <div id="time-text" class="glitch-effect" data-text="00:00">00:00</div>
                <div id="date-text">XXXX.XX.XX</div>
            </div>
        </div>

        <div class="search-container">
            <input type="text" id="search" placeholder=">> ENTER COMMAND...">
        </div>
    </div>

    <div class="widget-deck">
        <a class="widget" href="https://weather.yahoo.co.jp/weather/jp/22/5010.html" target="_blank">
            <div class="widget-label">SHIZUOKA / WEATHER</div>
            <div class="weather-main">
                <div class="temp-big" id="temp">--¬∞</div>
                <div class="weather-icon" id="w-icon">‚òÅ</div>
            </div>
            <div class="loc-small">Live Update: Active</div>
        </a>

        <a class="widget" href="clock-timer://">
            <div class="widget-label">TIMER APP</div>
            <div class="watch-face">
                <div class="watch-knob"></div>
                <div class="watch-hand"></div>
            </div>
            <div style="margin-top:15px; font-size:10px; color:#aaa;">OPEN SYSTEM CLOCK</div>
        </a>

        <div class="widget">
            <div class="widget-label">SYSTEM LOAD</div>
            <div class="bar-container" id="load-bars">
                </div>
        </div>

        <div class="widget">
            <div class="widget-label">MEMO LOG</div>
            <textarea id="memo-area" placeholder="Write logs here..."></textarea>
        </div>
    </div>

    <script>
        // === 1. ÊôÇË®à & „Ç∞„É™„ÉÉ„ÉÅ ===
        function updateClock() {
            const now = new Date();
            const h = String(now.getHours()).padStart(2, '0');
            const m = String(now.getMinutes()).padStart(2, '0');
            const timeStr = `${h}:${m}`;
            
            const timeEl = document.getElementById('time-text');
            timeEl.innerText = timeStr;
            timeEl.setAttribute('data-text', timeStr); // „Ç∞„É™„ÉÉ„ÉÅÁî®Â±ûÊÄßÊõ¥Êñ∞
            
            const days = ['SUN','MON','TUE','WED','THU','FRI','SAT'];
            document.getElementById('date-text').innerText = 
                `${now.getFullYear()}.${String(now.getMonth()+1).padStart(2,'0')}.${String(now.getDate()).padStart(2,'0')} [${days[now.getDay()]}]`;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // === 2. Â§©Ê∞ó‰∫àÂ†± (ÈùôÂ≤°Â∏Ç: 34.9756, 138.3828) ===
        async function fetchWeather() {
            try {
                // ÈùôÂ≤°Â∏Ç„ÅÆÂ∫ßÊ®ôÂõ∫ÂÆö
                const lat = 34.9756;
                const lon = 138.3828;
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`;
                
                const res = await fetch(url);
                const data = await res.json();
                
                const temp = Math.round(data.current_weather.temperature);
                const code = data.current_weather.weathercode;
                
                document.getElementById('temp').innerText = `${temp}¬∞C`;
                
                let icon = "‚òÅ";
                if(code === 0) icon = "‚òÄ";
                else if(code <= 3) icon = "‚õÖ";
                else if(code <= 67) icon = "‚òÇ";
                else if(code <= 86) icon = "‚ùÑ";
                else icon = "‚õà";
                document.getElementById('w-icon').innerText = icon;

            } catch (e) {
                document.getElementById('temp').innerText = "ERR";
            }
        }
        fetchWeather();
        setInterval(fetchWeather, 600000); // 10ÂàÜÊõ¥Êñ∞

        // === 3. „Ç∑„Çπ„ÉÜ„É†Ë≤†Ëç∑ÔºàÈ£æ„ÇäÔºâ ===
        const barContainer = document.getElementById('load-bars');
        for(let i=0; i<10; i++) {
            const bar = document.createElement('div');
            bar.className = 'bar';
            bar.style.height = Math.random() * 100 + "%";
            barContainer.appendChild(bar);
        }
        setInterval(() => {
            const bars = document.querySelectorAll('.bar');
            bars.forEach(b => {
                b.style.height = Math.random() * 100 + "%";
                b.style.background = Math.random() > 0.5 ? "var(--neon-cyan)" : "var(--neon-purple)";
            });
        }, 800);

        // === 4. „É°„É¢Â∏≥ÔºàËá™Âãï‰øùÂ≠òÔºâ ===
        const memoArea = document.getElementById('memo-area');
        // Ë™≠„ÅøËæº„Åø
        if(localStorage.getItem('myMemo')) {
            memoArea.value = localStorage.getItem('myMemo');
        }
        // ‰øùÂ≠ò
        memoArea.addEventListener('input', () => {
            localStorage.setItem('myMemo', memoArea.value);
        });

        // === 5. Ê§úÁ¥¢Ê©üËÉΩ ===
        const sBox = document.getElementById('search');
        sBox.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const q = sBox.value;
                if(q) location.href = `https://www.google.com/search?q=${encodeURIComponent(q)}`;
            }
        });

        // PWAÁôªÈå≤
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("service-worker.js");
        }
    </script>
</body>
</html>
